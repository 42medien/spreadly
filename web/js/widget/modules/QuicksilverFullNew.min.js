
var json_parse=(function(){var at,ch,escapee={'"':'"','\\':'\\','/':'/',b:'\b',f:'\f',n:'\n',r:'\r',t:'\t'},text,error=function(m){throw{name:'SyntaxError',message:m,at:at,text:text};},next=function(c){if(c&&c!==ch){error("Expected '"+c+"' instead of '"+ch+"'");}
ch=text.charAt(at);at+=1;return ch;},number=function(){var number,string='';if(ch==='-'){string='-';next('-');}
while(ch>='0'&&ch<='9'){string+=ch;next();}
if(ch==='.'){string+='.';while(next()&&ch>='0'&&ch<='9'){string+=ch;}}
if(ch==='e'||ch==='E'){string+=ch;next();if(ch==='-'||ch==='+'){string+=ch;next();}
while(ch>='0'&&ch<='9'){string+=ch;next();}}
number=+string;if(isNaN(number)){error("Bad number");}else{return number;}},string=function(){var hex,i,string='',uffff;if(ch==='"'){while(next()){if(ch==='"'){next();return string;}else if(ch==='\\'){next();if(ch==='u'){uffff=0;for(i=0;i<4;i+=1){hex=parseInt(next(),16);if(!isFinite(hex)){break;}
uffff=uffff*16+hex;}
string+=String.fromCharCode(uffff);}else if(typeof escapee[ch]==='string'){string+=escapee[ch];}else{break;}}else{string+=ch;}}}
error("Bad string");},white=function(){while(ch&&ch<=' '){next();}},word=function(){switch(ch){case't':next('t');next('r');next('u');next('e');return true;case'f':next('f');next('a');next('l');next('s');next('e');return false;case'n':next('n');next('u');next('l');next('l');return null;}
error("Unexpected '"+ch+"'");},value,array=function(){var array=[];if(ch==='['){next('[');white();if(ch===']'){next(']');return array;}
while(ch){array.push(value());white();if(ch===']'){next(']');return array;}
next(',');white();}}
error("Bad array");},object=function(){var key,object={};if(ch==='{'){next('{');white();if(ch==='}'){next('}');return object;}
while(ch){key=string();white();next(':');if(Object.hasOwnProperty.call(object,key)){error('Duplicate key "'+key+'"');}
object[key]=value();white();if(ch==='}'){next('}');return object;}
next(',');white();}}
error("Bad object");};value=function(){white();switch(ch){case'{':return object();case'[':return array();case'"':return string();case'-':return number();default:return ch>='0'&&ch<='9'?number():word();}};return function(source,reviver){var result;text=source;at=0;ch=' ';result=value();white();if(ch){error("Syntax error");}
return typeof reviver==='function'?(function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}({'':result},'')):result;};}());var YiidUtils={hasClass:function(ele,cls){if(ele===null){return false;}
return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));},addClass:function(ele,cls){if(!YiidUtils.hasClass(ele,cls)){ele.className+=" "+cls;}},removeClass:function(ele,cls){if(YiidUtils.hasClass(ele,cls)){var reg=new RegExp('(\\s|^)'+cls+'(\\s|$)');ele.className=ele.className.replace(reg,' ');}},toggleClass:function(pElement,pRemove,pInsert){if(YiidUtils.hasClass(pElement,pRemove)){YiidUtils.removeClass(pElement,pRemove);YiidUtils.addClass(pElement,pInsert);}},getElementsByClass:function(domNode,searchClass,tagName){if(domNode==null)domNode=document;if(tagName==null)tagName='*';var el=new Array();var tags=domNode.getElementsByTagName(tagName);var tcl=" "+searchClass+" ";for(i=0,j=0;i<tags.length;i++){var test=" "+tags[i].className+" ";if(test.indexOf(tcl)!=-1)
el[j++]=tags[i];}
return el;},getInnerText:function(pElement){if(document.all){return pElement.innerText;}else{return pElement.textContent;}},setInnerText:function(pElement,pText){if(document.all){pElement.innerText=pText;}else{pElement.textContent=pText;}},AddEventListener:function(element,eventType,handler,capture){if(element.addEventListener){element.addEventListener(eventType,handler,capture);}else if(element.attachEvent){element.attachEvent("on"+eventType,handler);}},unbindEvent:function(pElement,pEvent){pElement.pEventType=null;},openPopup:function(pUrl,pCase){if(pCase!=undefined){YiidRequest.doSendLike(pCase);}
var lPopup=window.open(pUrl,'popup','width=600,height=500,scrollbars=no,toolbar=no,status=no,resizable=no,menubar=no,location=0,directories=no,top=150,left=150');if(lPopup){return true;}else{return false;}},setAttr:function(pElement,pAttribute,pValue){lAttr=document.createAttribute(pAttribute);lAttr.nodeValue=pValue;pElement.setAttributeNode(lAttr);},deleteElement:function(pElement){var lParent=pElement.parentNode;while(pElement.hasChildNodes()){pElement.removeChild(pElement.lastChild);}
lParent.removeChild(pElement);},emptyElement:function(pElement){while(pElement.hasChildNodes()){pElement.removeChild(pElement.lastChild);}},createXMLHttpRequest:function(){var lXhttp=null;if(window.ActiveXObject){try{lXhttp=new ActiveXObject("MSXML2.XMLHTTP");}catch(e){try{lXhttp=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){lXhttp=false;}}}else if(window.XMLHttpRequest){try{lXhttp=new XMLHttpRequest();}catch(e){lXhttp=false;}}
return lXhttp;},implode:function(glue,pieces){var i='',retVal='',tGlue='';if(arguments.length===1){pieces=glue;glue='';}
if(typeof(pieces)==='object'){if(pieces instanceof Array){return pieces.join(glue);}
else{for(i in pieces){retVal+=tGlue+pieces[i];tGlue=glue;}
return retVal;}}
else{return pieces;}}};var YiidCookie={aCookieName:"yiidservices",aTimecheck:"yiidservices_timecheck",aDomain:"",getCookie:function(pName){var results=document.cookie.match('(^|;) ?'+pName+'=([^;]*)(;|$)');if(results){return(unescape(results[2]));}else{return null;}},isCookieSet:function(){if(YiidCookie.getCookie(YiidCookie.aCookieName)===null){return false;}
return true;}};YiidServices={aSettings:[],aTimecheck:null,initSettings:function(){var lCookie=YiidCookie.getCookie(YiidCookie.aCookieName);if(lCookie!=null){YiidServices.aSettings=json_parse(lCookie);}
var lTimestamp=YiidCookie.getCookie(YiidCookie.aTimecheck);if(lTimestamp!=null){YiidServices.aTimecheck=lTimestamp;}},updateSettings:function(){var lIndex,lHref;lHref=this.getAttribute('href');lIndex=lHref.match(/[0-9]+/g);var lObjects=YiidServices.aSettings;var lActive=lObjects[lIndex].active;if(lActive==0){lObjects[lIndex].active="1";}else{lObjects[lIndex].active="0";}
YiidUtils.setAttr(this,'id',lObjects[lIndex].name+"_"+lObjects[lIndex].active);},encodeSettings:function(){var lObjects=YiidServices.aSettings;var lOis=new Array();for(var i=0;i<lObjects.length;i++){if(lObjects[i].active==1){lOis.push(lObjects[i].oi_id);}}
var lString=YiidUtils.implode(',',lOis);return lString;},getActualTimestamp:function(){var lTimestamp=YiidCookie.getCookie(YiidCookie.aTimecheck);if(lTimestamp!=null){return lTimestamp;}}};var YiidSlider={aClickElement:null,aClickElementToOpen:null,aClickElementToClose:null,aTextAreaElement:null,aSlideElement:null,aOffsetWidth:'',aSlidingArea:null,aClickSlideInEvent:null,init:function(){if(YiidSlider.aSlideElement===null){YiidSlider.aSlideElement=document.getElementById('slide-box');}
if(YiidSlider.aClickElementToOpen===null){YiidSlider.aClickElementToOpen=document.getElementById('open_settings_icon_area');}
if(YiidSlider.aClickElementToClose===null){YiidSlider.aClickElementToClose=document.getElementById('slide_arrow_opened');}
if(YiidSlider.aSlidingArea===null){YiidSlider.aSlidingArea=document.getElementById('sliding_area');}
if(YiidSlider.aTextAreaElement===null){YiidSlider.aTextAreaElement=document.getElementById('additional_text_area');}},slideIn:function(pEvent){YiidSlider.aClickSlideInEvent=pEvent;YiidButtons.disable();YiidInfo.disable();var i=1;YiidSlider.stopInterval();YiidSlider.aClickElementToClose.style.display='block';if(YiidServices.aTimecheck<YiidServices.getActualTimestamp()){YiidServices.initSettings();}
YiidSlider.removeCell();YiidSlider.insertCell();YiidSlider.aSlidingArea.style.display='block';YiidSlider.aOffsetWidth=document.getElementById('slide_table').offsetWidth+12;YiidSlider.aSlideElement.timer=window.setInterval(function(){if(i>=YiidSlider.aOffsetWidth){YiidSlider.toggleClickElement();YiidSlider.stopInterval();}else{YiidSlider.aSlideElement.style.width=i+'px';i=i+4;}},10);return false;},slideOut:function(){YiidSlider.aClickSlideInEvent=null;YiidSlider.stopInterval();YiidSlider.aSlideElement.timer=window.setInterval(function(){if(YiidSlider.aOffsetWidth>0){YiidSlider.aSlideElement.style.width=YiidSlider.aOffsetWidth+'px';YiidSlider.aOffsetWidth=YiidSlider.aOffsetWidth-8;}else{YiidSlider.toggleClickElement();YiidSlider.aSlidingArea.style.display='none';YiidButtons.enable();YiidSlider.stopInterval();YiidInfo.enable();}},10);return false;},insertCell:function(){var lRow=document.getElementById('slide-row');var lObjects=YiidServices.aSettings;var lCell,lLink;for(var i=0;i<lObjects.length;i++){lCell=lRow.insertCell(i);lLink=document.createElement('a');lCell.appendChild(lLink);YiidUtils.setAttr(lLink,'href',"#"+i);YiidUtils.setAttr(lLink,'id',lObjects[i].name+"_"+lObjects[i].active);YiidUtils.setAttr(lLink,'class','favicon');YiidUtils.setAttr(lLink,'title',lObjects[i].identifier);lLink.onclick=YiidServices.updateSettings;var lText=document.createTextNode('\u00A0');lLink.appendChild(lText);}},removeCell:function(){var lRow=document.getElementById('slide-row');var lChilds=lRow.getElementsByTagName('td');var lLength=lChilds.length;for(var i=0;i<lLength;i++){if(lChilds[0].id!=='settings-area'){lRow.removeChild(lChilds[0]);}}
return true;},stopInterval:function(){clearInterval(YiidSlider.aSlideElement.timer);YiidSlider.aSlideElement.timer=null;},showClickElement:function(){YiidSlider.init();YiidUtils.toggleClass(YiidSlider.aTextAreaElement,'big_space_to_left','small_space_to_left');YiidSlider.aClickElementToOpen.style.display='block';},hideClickElement:function(pEvent){if(YiidSlider.aClickSlideInEvent!=null){pEvent=null;}else{YiidUtils.toggleClass(YiidSlider.aTextAreaElement,'small_space_to_left','big_space_to_left');YiidSlider.aClickElementToOpen.style.display='none';}},toggleClickElement:function(){if(YiidUtils.hasClass(YiidSlider.aClickElement,'closed')){YiidUtils.toggleClass(YiidSlider.aClickElement,'closed','opened');}else{YiidUtils.toggleClass(YiidSlider.aClickElement,'opened','closed');}}};var YiidError={showError:function(pMessage){if(pMessage==undefined){pMessage="Error: Something went wrong. <span id='err-signup'>Login</span> and retry!";}
var lAddText=document.getElementById('additional_text_area');YiidUtils.emptyElement(lAddText);var lBlock=document.createElement('p');YiidUtils.setAttr(lBlock,'id','error-msg')
lBlock.innerHTML=pMessage;lAddText.appendChild(lBlock);},showHttpError:function(pXhttp){var lInfoElem=document.getElementById('infelem');if(pXhttp.statusText==''){pXhttp.statusText="Error: Something went wrong";}
lInfoElem.style.display="none";},undefinedError:function(pError){return true;}};var YiidWidget={aUrl:'',aType:'',aTitle:'',aDescription:'',aPhoto:'',aPopupPath:null,aServiceSettings:new Array(),init:function(pUrl,pType,pTitle,pDescription,pPhoto){YiidWidget.aUrl=pUrl;YiidWidget.aType=pType;YiidWidget.aTitle=pTitle;YiidWidget.aDescription=pDescription;YiidWidget.aPhoto=pPhoto;YiidServices.initSettings();},doLike:function(pCase){if(YiidServices.aTimecheck<YiidServices.getActualTimestamp()){YiidServices.initSettings();}
var lPossible=YiidWidget.isLikePossible();YiidSlider.init();if(lPossible===1){YiidRequest.doSendLike(pCase);YiidWidget.markAsUsed();if(pCase==1){YiidButtons.markLiked();YiidInfo.markLiked();}else{YiidButtons.markDisliked();YiidInfo.markDisliked();}}else if(lPossible===0){YiidSlider.slideIn();}else{YiidRequest.doSendLike(pCase);YiidUtils.openPopup(YiidWidget.aPopupPath);}
return false;},isLikePossible:function(){var lCookie=YiidCookie.getCookie(YiidCookie.aCookieName);if(lCookie){var lObjects=YiidServices.aSettings;var lObjectLength=lObjects.length;if(lObjectLength>0){for(var i=0;i<lObjects.length;i++){if(lObjects[i].active==1){return 1;}}
return 0;}}
return 2;},markAsUsed:function(){var lButton=document.getElementById('container_full');lButton.style.display="none";var lUsedButton=document.getElementById('container_used');lUsedButton.style.display="block";},markAsUnused:function(){var lButton=document.getElementById('container_used');lButton.style.display="none";var lUnusedButton=document.getElementById('container_full');lUnusedButton.style.display="";}};var YiidInfo={markLiked:function(){var lLike=document.getElementById('you-like');lLike.style.display="inline";},markDisliked:function(){var lDislike=document.getElementById('you-dislike');lDislike.style.display="inline";},disable:function(){document.getElementById('additional_text_area').style.display="none";},enable:function(){document.getElementById('additional_text_area').style.display="block";}};var YiidButtons={disable:function(){var lButton=document.getElementById('normal_button');var lSettings=document.getElementById('settings_button');if(lButton&&lSettings){lButton.style.display="none";lSettings.style.display="block";}},enable:function(){var lButton=document.getElementById('normal_button');var lSettings=document.getElementById('settings_button');if(lButton&&lSettings){lSettings.style.display="none";lButton.style.display="block";}},markLiked:function(){var lLikedText=document.getElementById('liked-text');lLikedText.style.display="block";},markDisliked:function(){var lDislikedText=document.getElementById('disliked-text');lDislikedText.style.display="block";}};var YiidRequest={aDislikeAction:'',aLikeAction:'',doSendLike:function(pCase,pOpenPopup){var lXhttp=YiidUtils.createXMLHttpRequest();if(lXhttp!=null){try{var lAction=YiidRequest.aLikeAction;if(pCase===0){lAction=YiidRequest.aDislikeAction;}
var lQuery=encodeURI('url='+YiidWidget.aUrl+'&type='+YiidWidget.aType+'&case='+pCase+'&serv='+YiidServices.encodeSettings()+'&title='+YiidWidget.aTitle+'&description='+YiidWidget.aDescription+'&photo='+YiidWidget.aPhoto);lXhttp.open("POST",lAction,true);lXhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");lXhttp.setRequestHeader("Content-length",lQuery.length);lXhttp.setRequestHeader("Connection","close");lXhttp.onreadystatechange=function(){if(lXhttp.readyState==4){if(lXhttp.status!=200){}else{YiidRequest.delegateResponse(lXhttp);}}};lXhttp.send(lQuery);}catch(lError){YiidError.undefinedError(lError);}}},delegateResponse:function(pXhttp){var lResponse=pXhttp.responseText;var lJson=json_parse(lResponse);if(lJson.success===false){if(lJson.status=='401'){YiidWidget.markAsUnused();YiidError.showError(lJson.message);}else{}}}};